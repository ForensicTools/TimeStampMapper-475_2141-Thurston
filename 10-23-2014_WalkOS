# !/usr/bin/python

######################
#
# Will Thurston
# Time_Stamp_Mapper
#
######################


from __future__ import print_function
import os, time, sys, datetime


#Grabs the wanted directory from the user and checks if directory exists
def get_directory(direcinput='Input a directory path: '):
    while True:
        direcpath = input(direcinput)
        if os.path.isdir(direcpath):
            return direcpath
        print('%r is not a directory. Try again.' % direcpath)


#Open the file to write to
output = open('TimeStamp.txt','w')


#Recursively go through the specified directory
for root, dirs, files in os.walk(get_directory() , topdown=False):
    for filename in files:
        print(os.path.join(root, filename))
        output.write(os.path.join(root, filename))
        output.write("\n")

        # stat information of file
        stinfo = os.stat(os.path.join(root, filename))

        #Modify atime, ctime, and mtime timestamp sting to human-readable date
        createTime = datetime.datetime.fromtimestamp(int(stinfo.st_ctime)).strftime('%Y-%m-%d %H:%M:%S')
        accessTime = datetime.datetime.fromtimestamp(int(stinfo.st_atime)).strftime('%Y-%m-%d %H:%M:%S')
        modifiedTime = datetime.datetime.fromtimestamp(int(stinfo.st_mtime)).strftime('%Y-%m-%d %H:%M:%S')

        
        # Using os.stat to recieve atime, ctime, and mtime of file and write to the file
        print ("Create time: %s" %createTime)
        output.write( "Create time: %s\n" %createTime )
        print ("Access time: %s" %accessTime)
        output.write( "Access time: %s\n" %accessTime )
        print ("Modified time: %s" %modifiedTime)
        output.write( "Modified time: %s\n" %modifiedTime )
        print ("\n\n\n")
        output.write("\n\n\n")

    for filename in dirs:
        print(os.path.join(root, filename))


#Close output file       
output.close()
